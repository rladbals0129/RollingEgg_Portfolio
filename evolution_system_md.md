# 4. 진화 시스템

## 4.1. 진화 조건

진화가 가능한 조건:
- **육성 레벨 5 이상** 달성
- **진화 확인 팝업 내 진화 버튼 선택**

진화 후 처리:
- 해당 알의 육성 레벨 및 진화 스텟 초기화

---

## 4.2. 진화 확률 계산

- 알별 진화 당시의 **육성 레벨**과 **지배 스텟**에 따라 결정되는 진화체가 다름
- 5개의 진화 스텟 중 **가장 높은 값**을 확인 후 현재 육성 레벨 구간에 맞는 확률을 계산하여 진화체를 결정

---

## 4.3. 진화 테이블 – Evolution 테이블

### 진화 확률 계산 방식

1. **지배 스텟 타입**을 우선 확인
2. 현재 **육성 레벨 구간**을 확인
3. 해당하는 확률로 진화체 결정

**예시:**
- 진화 시점의 지배 스텟이 1번 스텟
- 현재 육성 레벨이 11
- → id 2번의 확률로 계산 (요리사 70%, 경찰관 27%, 아이돌 3%)

### 진화 테이블 구조

| id | 알 타입 | 지배 스텟 타입 | 최소 육성 레벨 | 1번 진화체 | 확률 | 2번 진화체 | 확률 | 3번 진화체 | 확률 |
|---|---|---|---|---|---|---|---|---|---|
| 1 | 파란알 | 1 | 5 | 요리사 | 90% | 경찰관 | 10% | 아이돌 | 0% |
| 2 | 파란알 | 1 | 10 | 요리사 | 70% | 경찰관 | 27% | 아이돌 | 3% |
| 3 | 파란알 | 1 | 20 | 요리사 | 60% | 경찰관 | 35% | 아이돌 | 5% |
| 4 | 파란알 | 1 | 30 | 요리사 | 50% | 경찰관 | 40% | 아이돌 | 10% |
| 5 | 파란알 | 2 | 5 | 직장인 | 90% | 변호사 | 10% | 의사 | 0% |

*(전체 테이블은 원본 문서 참조)*

---

## 4.4. 중복 진화체 획득 시

### 처리 플로우

```
진화체 결정
    ↓
중복 진화체인가?
    ↓
   YES → 해당 알의 전용 재화로 치환 → 재화 획득
    ↓
   NO → 도감 등록
```

### UI 안내 메시지

**신규 진화체 획득 시:**
```
진화 완료

[진화 전 알 이미지] → [진화체 이미지]
하얀알           요리사

오늘은 내가 요리사!

새로운 진화체를 획득하여 도감에 등록되었습니다.
```

**중복 진화체 획득 시:**
```
진화 완료

[진화 전 알 이미지] → [진화체 이미지]
하얀알           요리사

오늘은 내가 요리사!

중복 진화체를 획득하여 456개를 획득하였습니다.
```

- 진화 완료 팝업 내 중복 진화체 여부에 따라 하단 안내 메시지를 다르게 출력
- 치환되는 재화량은 도감 테이블에서 지정

---

## 4.5. 진화 플로우

### 전체 진화 과정

1. **육성 레벨 5 도달**
2. **진화 버튼 출력**
3. **플레이어가 진화 버튼 터치**
4. **진화 확인 팝업 출력**
   - 팝업 내 예상 진화체 3종의 확률 출력
5. **팝업 내 확인 버튼 선택**
6. **진화 팝업 출력**
   - 진화체 이미지: "빛의 알 → 천사맛 쿠키"
   - "도감에 등록되었습니다!" (신규) OR "중복 획득으로 ○ 45 획득!" (중복)
7. **확인 버튼 → 진화 완료 팝업 종료 → 알들의 공간 복귀**
8. **해당 알 육성 레벨, 진화 스텟 0으로 리셋**

### 진화 스텟과 육성 레벨 리셋
- 진화 완료 후 해당 알의 모든 진화 스텟과 육성 레벨이 0으로 초기화됨

---

## 4.6. 진화 UI

### 진화 확인 팝업 UI 구성

```
┌─────────────────────────────────────┐
│         진화                         │
├─────────────────────────────────────┤
│  알에 큰 변화가 생길 것 같아요!      │
│  지금 진화에 도전할까요?             │
│                                      │
│  예상 진화 결과                      │
│  ┌───────────────────────────────┐  │
│  │ [요리사 이미지]                 │  │
│  │ 요리사 55%                      │  │
│  ├───────────────────────────────┤  │
│  │ [화가 이미지]                   │  │
│  │ 화가 25%                        │  │
│  ├───────────────────────────────┤  │
│  │ [직장인 이미지]                 │  │
│  │ 직장인 20%                      │  │
│  └───────────────────────────────┘  │
│                                      │
│  [지금 안 할래요] [지금 진화하자!]   │
└─────────────────────────────────────┘
```

**UI 요소 설명:**
- **진화 팝업 타이틀**: "진화"
- **진화 팝업 안내 메시지**: "알에 큰 변화가 생길 것 같아요! 지금 진화에 도전할까요?"
- **예상 진화 결과 3종 출력**: 진화체 이미지와 명칭, 확률 표시
- **버튼**:
  - "지금 안 할래요": 진화 없이 진화 팝업 종료
  - "지금 진화하자!": 진화 결과창 출력 (확률 돌려서 당첨 진화체 출력)

---

### 진화 완료 팝업 UI 구성

```
┌─────────────────────────────────────┐
│         진화 완료                    │
├─────────────────────────────────────┤
│  [파란알 이미지] → [요리사 이미지]   │
│     파란알            요리사          │
│                                      │
│  오늘은 내가 요리사!                 │
│  (진화체 별 대사)                    │
│                                      │
│  새로운 진화체를 획득하여             │
│  도감에 등록되었습니다.               │
│  또는                                │
│  중복 진화체를 획득하여               │
│  456개를 획득하였습니다.              │
│                                      │
│              [확인]                  │
└─────────────────────────────────────┘
```

**UI 요소 설명:**
- **진화 완료 화면 타이틀**: "진화 완료"
- **진화 전후 이미지**: 진화 전 알과 하단 명칭 출력 → 진화체의 이미지와 하단 명칭 출력
- **진화체 별 대사 출력**: 각 진화체마다 고유한 대사
- **진화 결과 안내 메시지**:
  - 신규 진화체 획득 시: "새로운 진화체를 획득하여 도감에 등록되었습니다."
  - 중복 진화체 획득 시: "중복 진화체를 획득하여 XXX개를 획득하였습니다." (재화로 치환되었음을 안내)

---

## 요약

진화 시스템은 플레이어가 육성한 알이 특정 조건을 만족했을 때 다양한 형태로 변화하는 핵심 콘텐츠입니다. 진화 결과는 육성 레벨과 지배 스텟에 따라 확률적으로 결정되며, 중복 진화체는 재화로 치환되어 플레이어에게 지속적인 보상을 제공합니다.